# ×”×ª×¨×¢×•×ª ×¤×™×§×•×“ ×”×¢×•×¨×£ / ×¦×‘×¢ ××“×•× ×‘××¢×¨×›×ª Home Assistant (AppDaemon)
***×–×”×• ×œ× ×ª×•×¡×£ ×¨×©××™ ×©×œ ×¤×™×§×•×“ ×”×¢×•×¨×£***. 
×§×™×™××ª ×’×¨×¡×” ×‘×©×¤×” ×”×× ×’×œ×™×ª ×¢× ××™×“×¢ ××•×¨×—×‘ ×•×¢×•×“ ×“×•×’×××•×ª/×©×™××•×©×™× ×‘×¨×›×™×‘: https://github.com/idodov/RedAlert

**×¡×§×¨×™×¤×˜ ×–×” ×™×•×¦×¨ ×™×™×©×•×ª/×—×™×™×©×Ÿ ×‘×™× ××¨×™ ×œ××¢×§×‘ ××—×¨ ××¦×‘ ×”×ª×¨×¢×•×ª ×¤×™×§×•×“ ×”×¢×•×¨×£ ×‘×™×©×¨××œ. ×”×—×™×™×©×Ÿ ×™×›×•×œ ×œ×”×™×•×ª ×©××™×© ×‘×ª×¨×—×™×©×™× (××•×˜×•××¦×™×•×ª) ×•/××• ×œ×™×¦×•×¨ ××× ×• ×—×™×™×©× ×™ ××©× ×”/×—×™×™×©× ×™× ×‘×™× ××¨×™×™×.**
×”×”×—×™×™×©×Ÿ ××¡×¤×§ ×”×ª×¨×¢×” ×œ×›×œ ×¡×•×’×™ ×”××™×•××™× ×©×¤×™×§×•×“ ×”×¢×•×¨×£ ××ª×¨×™×¢, ×œ×¨×‘×•×ª ×™×¨×™ ×¨×§×˜×•×ª ×•×˜×™×œ×™×, ×—×“×™×¨×ª ×›×œ×™ ×˜×™×™×¡ ×¢×•×™×™× ×™×, ×—×“×™×¨×ª ××—×‘×œ×™×, ×¨×¢×™×“×ª ××“××”, ×—×©×©×•×ª ×œ×¦×•× ×××™ ×•×›×œ ××™×•× ××—×¨.

×œ××ª×¨ ×”×ª×§× ×ª ×”×—×™×™×©×Ÿ ×ª×™×™×¦×¨ ×™×©×•×ª ×—×“×©×” ×‘××¢×¨×›×ª HA ×‘×©× ***binary_sensor.oref_alert***. ×™×©×•×ª ×–×• ×ª×”×™×” ××•×¤×¢×œ×ª ×‘×–××Ÿ ×”×ª×¨×¢×” ×•×›×‘×•×™×™×” ×›×©××™×Ÿ ×”×ª×¨×¢×”. ×”×™×™×©×•×ª ×›×•×œ×œ×ª ×¤×¨×˜×™ ××™×“×¢ × ×•×¡×¤×™×, ××•×ª× × ×™×ª×Ÿ ×œ×—×œ×¥ ×•×œ×”×©×ª××© ×‘×”× ×œ×¦×¨×›×™ ×ª×¦×•×’×” ××• ×˜×¨×™×’×¨×™× ×œ×”×¤×¢×œ×ª ×ª×¨×—×™×©×™×.
×”××™×™×§×•×Ÿ ×•×›×•×ª×¨×ª ×”×—×™×™×©×Ÿ, ×›×¤×•×¤×™× ×œ×©×™× ×•×™ ×“×™× ××™ ×¢× ×›×œ ×”×ª×¨×¢×” ×—×“×©×”. ×œ×©× ×”××—×©×”, ×‘××§×¨×” ×©×œ ×™×¨×™ ×¨×§×˜×•×ª ×•×˜×™×œ×™× ×”××™×™×§×•×Ÿ ×©×œ ×”×—×™×™×©×Ÿ ×™×¦×™×’ ×”×¡××œ ×”××ª××¨ ×¨×§×˜×”. ×‘× ×•×¡×£, ×§×™×™× ××™××•×’'×™ × ×¤×¨×“ ×”××©×•×™×š ×œ×›×œ ×¡×•×’ ×”×ª×¨×¢×” ××•×ª×• × ×™×ª×Ÿ ×œ×”×¦×™×’ ×œ×¦×“ ×”×•×“×¢×ª ×”×”×ª×¨×¢×”.

![Capture](https://github.com/idodov/RedAlert/assets/19820046/79adf8ff-1369-472b-a463-0c1fe82a9c4d)
![Capture--](https://github.com/idodov/RedAlert/assets/19820046/2cdee4bb-0849-4dc1-bb78-c2e282300fdd)
![000](https://github.com/idodov/RedAlert/assets/19820046/22c3336b-cb39-42f9-8b32-195d9b6447b2)
### ×—×©×•×‘ ×œ×“×¢×ª
* ×œ××—×¨ ×”×ª×ª×§× ×” ×•×œ×¤× ×™ ×©××ª×§×™×™××ª ×‘×¤×•×¢×œ ×”×ª×¨×¢×” ××¤×™×§×•×“ ×”×¢×•×¨×£, ×ª×ª×™ ×”×—×™×™×©× ×™× ×©×™×•×•×¦×¨×• ×™×•×¦×’×• ×›×œ× ×–××™× ×™×. ×–×” ×§×•×¨×” ××›×™×•×•×Ÿ ×©×œ×—×™×™×©×Ÿ ××™×Ÿ × ×ª×•× ×™× ×××•×—×¡× ×™× ×œ×”×ª×™×™×—×¡×•×ª ×¢×“ ×œ×”×ª×¨×—×©×•×ª ×”×”×ª×¨×¢×” ×”×¨××©×•× ×”.
* ×©×™×˜×ª ×”×ª×§× ×” ×–×• ××ª×‘×¡×¡×ª ×¢×œ ××¢×¨×›×ª ×”×”×¤×¢×œ×” ×©×œ Home Assistant
* ××× × ×–×” ×œ× ×—×•×‘×”, ××‘×œ ××•××œ×¥ ×˜×¨× ×ª×—×™×œ×ª ×”×”×ª×§× ×” ×œ×™×¦×•×¨ ××ª ×”×—×™×™×©×Ÿ ××××¡×š UI Helper. ×–××ª ××”×¡×™×‘×” ×©×”×—×™×™×©×Ÿ ×××¤×¡ ××ª ×”× ×ª×•× ×™× ×©×œ×• ×œ××—×¨ ×”×¤×¢×œ×” ××—×“×© ×©×œ Home Assistant Core, ×•×›×ª×•×¦××” ××›×š ×™×ª×›× ×• ××•×‘×“×Ÿ × ×ª×•× ×™× ×§×•×“××™×.
×›×“×™ ×œ×˜×¤×œ ×‘×–×”, ××•××œ×¥ ×œ×™×¦×•×¨ **×—×™×™×©×Ÿ ×‘×™× ××¨×™** ×©×œ ××¡×•×’ ×ª×‘× ×™×ª
**×œ×¤× ×™ ×”×”×ª×§× ×”**. ×›×“×™ ×œ×¢×©×•×ª ×–××ª:
1. ×ª×¤×¨×™×˜ Home Assistant ×•×œ××—×¨ ××›×Ÿ ××œ '**×”×’×“×¨×•×ª**', '**×”×ª×§× ×™× ×•×©×™×¨×•×ª×™×**', '**××¡×™×™×¢×™×**'
2. ×‘×—×¨ '**×¦×•×¨ ××¡×™×™×¢**'.
3. ×‘×—×¨ '**×ª×‘× ×™×ª**' ×•×‘×—×¨ '**××¡×™×™×¢ ×‘×™× ××¨×™ ×ª×‘× ×™×ª**'.
4. ×‘×©×“×” '**×©×**', ×”×–×Ÿ '**oref alert**'.
5. ×‘×©×“×” '**×ª×‘× ×™×ª**', ×”×–×Ÿ '**off**'.
6. ×œ×—×¥ ×¢×œ **×™×¦×™×¨×”**.
![b1](https://github.com/idodov/RedAlert/assets/19820046/e451fa8c-789b-4e88-ab98-4687b65f058e)


## ×”×•×¨××•×ª ×”×ª×§× ×”
1. ×”×™×›× ×¡ ××œ ××¡×š **×”×”×’×“×¨×•×ª**, ×‘×—×¨ **×”×¨×—×‘×•×ª** ×•××©× ××ª **×—× ×•×ª ×”×”×¨×—×‘×•×ª**
2. ×‘×—× ×•×ª ×”×”×¨×—×‘×•×ª ×™×© ×œ×—×¤×© ×”×¨×—×‘×” ×‘×©× "AppDaemon"
3. ×œ××—×¨ ×”×ª×§× ×ª×” ×™×© ×œ×”×¤×¢×™×œ ××¦×‘ **×›×œ×‘ ×©××™×¨×”** ×•××¦×‘ **×¢×“×›×•×Ÿ ××•×˜×•××˜×™** (×¢×“×™×™×Ÿ ×œ× ×œ×”×¨×™×¥ ××ª ×”×”×¨×—×‘×”)
4. ×™×© ×œ×’×©×ª ×œ×œ×©×•× ×™×ª **×ª×¦×•×¨×”** ×•×œ×”×•×¡×™×£ ×ª×—×ª ×”×”×’×“×¨×” "Python packages" ××ª ×”×”×’×“×¨×” "requests"

![Capture1](https://github.com/idodov/RedAlert/assets/19820046/d4e3800a-a59b-4605-b8fe-402942c3525b)

5. **×›×¢×ª ×™×© ×œ×”×¨×™×¥ ××ª ×”×”×¨×—×‘×”**
6. × ×“×¨×© ×œ×¤×ª×•×— FILE EDITOR (× ×™×ª×Ÿ ×œ×”×ª×§×™×Ÿ ×“×¨×š ×—× ×•×ª ×”×”×¨×—×‘×•×ª) ×•×œ×¤×ª×•×— ××ª ×”×§×•×‘×¥ `config/appdaemon/appdaemon.yaml/`
7. ×™×© ×œ×¢×“×›×Ÿ ××ª ×”× ×ª×•× ×™× ×”×‘××™×: 
××ª ××™×–×•×¨ ×”×–××Ÿ (`time_zone`) ×™×© ×œ×¢×“×›×Ÿ ×œ-"Asia/Jerusalem", ××ª ×”×’×“×¨×ª ×§×• ×”×¨×•×—×‘ (`latitude`) ×™×© ×œ×¢×“×›×Ÿ ×œ-"31.9837528", ××ª ×”×’×“×¨×ª ×§×• ×”××•×¨×š (`longitude`) ×™×© ×œ×¢×“×›×Ÿ ×œ-"34.7359077".
×× ×œ× ×§×™×™× ×œ×›× ×§×•×‘×¥ secret.yaml ×‘×ª×™×§×™×™×ª config, ××—×§×• ××ª ×”×©×•×¨×”: `secrets: /config/secrets.yaml`
```yaml
---
secrets: /config/secrets.yaml
appdaemon:
  latitude: 31.9837528
  longitude: 34.7359077
  elevation: 2
  time_zone: Asia/Jerusalem
  plugins:
    HASS:
      type: hass
http:
  url: http://127.0.0.1:5050
admin:
api:
hadashboard:
```
8. ×‘×¢×–×¨×ª FILE EDITOR × ×•×•×˜ ×œ×ª×™×§×™×™×” `config/appdaemon/apps/` ×•×”×§× ×§×•×‘×¥ ×‘×©× **orefalert.py** ××œ ×ª×•×›×• ×œ×”×¢×ª×™×§ ××ª ×”×§×•×“ ×”×‘×:
*×œ×ª×©×•××ª ×œ×™×‘×š, ×‘×§×•×“ ××•×’×“×¨ ×©×”×¡× ×¡×•×¨ ×™×‘×“×•×§ ××™×“×¢ ××•×œ ×¤×™×§×•×“ ×”×¢×•×¨×£ **×›×œ 3 ×©× ×™×•×ª**. × ×™×ª×Ÿ ×œ×©× ×•×ª ××ª ×”× ×ª×•×Ÿ `interval = 3` ×œ××¡×¤×¨ ××—×¨. ×œ×“×•×’×× 1 = ×©× ×™×™×”, 0.5 = ×—×¦×™ ×©× ×™×™×”.* 
```orefalert.py
import requests
import time
import json
import codecs
from datetime import datetime
from appdaemon.plugins.hass.hassapi import Hass

# Scan every 3 seconds
interval = 3 

class OrefAlert(Hass):
    def initialize(self):
        self.run_every(self.poll_alerts, datetime.now(), interval)

    def poll_alerts(self, kwargs):
        url = "https://www.oref.org.il/WarningMessages/alert/alerts.json"
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3',
            'Referer': 'https://www.oref.org.il/',
            'X-Requested-With': 'XMLHttpRequest',
            'Content-Type': 'application/json',
        }
        icons = {
                    1: "mdi:rocket-launch",
                    2: "mdi:home-alert",
                    3: "mdi:earth-box",
                    4: "mdi:chemical-weapon",
                    5: "mdi:waves",
                    6: "mdi:airplane",
                    7: "mdi:skull",
                    8: "mdi:alert",
                    9: "mdi:alert",
                    10: "mdi:alert",
                    11: "mdi:alert",
                    12: "mdi:alert",
                    13: "mdi:run-fast",
                    }
        icon_alert = "mdi:alert"
        emojis = {
                    1: "ğŸš€",
                    2: "âš ï¸",
                    3: "ğŸŒ",
                    4: "â˜¢ï¸",
                    5: "ğŸŒŠ",
                    6: "ğŸ›©ï¸",
                    7: "ğŸ’€",
                    8: "â—",
                    9: "â—",
                    10: "â—",
                    11: "â—",
                    12: "â—",
                    13: "ğŸ‘£ğŸ‘¹",
                    }
        icon_emoji = "ğŸš¨"
        try:
            response = requests.get(url, headers=headers)
            if response.status_code == 200:
                response_data = codecs.decode(response.content, 'utf-8-sig')
                if response_data.strip():  
                    try:
                        data = json.loads(response_data)
                        if 'data' in data and data['data']:
                            alert_title = data.get('title', '')
                            alerts_data = ', '.join(data['data'])
                            icon_alert = icons.get(int(data.get('cat', 1)), "mdi:alert")
                            icon_emoji = emojis.get(int(data.get('cat', 1)), "â—")
                            if isinstance(alerts_data, str):
                                data_count = len(alerts_data.split(','))
                            else:
                                data_count = 0
                            self.set_state(
                                "binary_sensor.oref_alert",
                                state="on",
                                attributes={
                                    "id": data.get('id', None),
                                    "cat": data.get('cat', None),
                                    "title": alert_title,
                                    "desc": data.get('desc', None),
                                    "data": alerts_data,
                                    "data_count": data_count,
                                    "last_changed": datetime.now().isoformat(),
                                    "prev_cat": data.get('cat', None),
                                    "prev_title": alert_title,
                                    "prev_desc": data.get('desc', None),
                                    "prev_data": alerts_data,
                                    "prev_last_changed": datetime.now().isoformat(),
                                    "icon": icon_alert,
                                    "emoji":  icon_emoji,
                                    "friendly_name": alert_title,
                                },
                            )
                        else:
# Clear the sensor if there is no data in the response
                            self.set_state(
                                "binary_sensor.oref_alert",
                                state="off",
                                attributes={
                                    "id": None,
                                    "cat": None,
                                    "title": None,
                                    "desc": None,
                                    "data": None,
                                    "data_count": 0,
                                    "last_changed": datetime.now().isoformat(),
                                    "icon": icon_alert,
                                    "emoji":  icon_emoji,
                                    "friendly_name": "××™×Ÿ ×”×ª×¨×¢×•×ª",
                                },
                            )
                    except json.JSONDecodeError:
                        self.log("Error: Invalid JSON format in the response.")
                else:
# Clear the binary_sensor state to off if there is no data in the response
                    self.set_state(
                        "binary_sensor.oref_alert",
                        state="off",
                        attributes={
                            "id": None,
                            "cat": None,
                            "title": None,
                            "desc": None,
                            "data": None,
                            "data_count": 0,
                            "icon": icon_alert,
                            "emoji":  icon_emoji,
                            "friendly_name": "××™×Ÿ ×”×ª×¨×¢×•×ª",
                        },
                    )
            else:
                self.log(f"Failed to retrieve data. Status code: {response.status_code}")
        except Exception as e:
            self.log(f"Error: {e}")
```
9. ×™×© ×œ×¤×ª×•×— ××ª ×”×§×•×‘×¥ **apps.yaml** ××©×¨ × ××¦× ×‘× ×ª×™×‘ `config/appdaemon/apps/` ×•×œ×”×•×¡×™×£ ××ª ×”×©×•×¨×•×ª ×”×‘××•×ª ×•×œ×©××•×¨:
```yaml
orefalert:
  module: orefalert
  class: OrefAlert
```
10. **×”×¤×¢×œ ××—×“×©** ××ª ×”×ª×•×¡×£ appdaemon.

×œ××—×¨ ×”×”×¤×¢×œ×” ×”×—×™×™×©×Ÿ ×™×”×™×” ×–××™×Ÿ ×œ×©×™××•×©. ×ª×—×™×œ×” ×”×—×™×™×©×Ÿ ×™×”×™×” ×‘××¦×‘ ×›×‘×•×™ ×œ×œ× × ×ª×•× ×™×, ×¢×“ ××©×¨ ×ª×ª×§×‘×œ ×”×ª×¨×¢×” ××¤×™×§×•×“ ×”×¢×•×¨×£, ×•××– ×§×œ ×™×•×ª×¨ ×™×”×™×” ×œ×”×§×™× ×ª×ª×™ ×—×™×™×©× ×™× × ×•×¡×¤×™× (×›×™ ×™×”×™×” ××™×“×¢ ×©××¤×©×¨ ×œ×”×ª×‘×¡×¡ ×¢×œ×™×•).
## ×“×•×’×××•×ª
×™×© ××¡×¤×¨ ×“×¨×›×™× ×œ×”×’×“×™×¨ ×—×™×™×©× ×™× × ×•×¡×¤×™× ××• ×˜×¨×™×’×¨×™× ×œ×ª×¨×—×™×©×™×. ×××•×“ ×—×©×•×‘ ×œ×©××•×¨ ×¢×œ ×›×œ×œ×™ ×›×ª×™×‘×ª ×”×§×•×“, ××—×¨×ª ×”×—×™×™×©×Ÿ ×œ× ×™×¢×‘×•×“ ×ª×§×™×Ÿ. ×œ×§×—×ª ×‘×—×©×‘×•×Ÿ ×©×× ×˜×¨× ×”×™×ª×” ×”×ª×¨×¢×” ×›×œ×©×”×™ ××¤×™×§×•×“ ×”×¢×•×¨×£ ×œ×¤× ×™ ×©××ª× ××’×“×™×¨×™× ×ª×ª×™ ×—×™×™×©× ×™×, ××ª× ×¢×œ×•×œ×™× ×œ×§×‘×œ ×¡×˜×˜×•×¡ "×‘×œ×ª×™ ×–××™×Ÿ" ×¢×‘×•×¨ ×”×—×™×™×©×Ÿ ×©×™×¦×¨×ª×. ××¦×‘ ×–×” ×™×©×ª× ×” ××™×“ ×œ××—×¨ ×©×ª×”×™×” ××–×¢×§×”.
### ×¢×™×¨ / ××–×•×¨ ×‘×¢×™×¨
**×˜×¨×™×’×¨ ×¢×‘×•×¨ ×ª×¨×—×™×©×™×**
```
{{ "×™×‘× ×”" in state_attr('binary_sensor.oref_alert', 'data').split(', ') }}
```
**×”×’×“×¨×ª ×¡× ×¡×•×¨ ×‘×™× ××¨×™ ×—×“×©**

```
{{ "×™×‘× ×”" in state_attr('binary_sensor.oref_alert', 'prev_data').split(', ') and is_state('binary_sensor.oref_alert','on') }}
```
### ××¡×¤×¨ ×¢×¨×™× / ××™×–×•×¨×™×
**×˜×¨×™×’×¨ ×¢×‘×•×¨ ×ª×¨×—×™×©×™×**
```
{{ "××™×¨×•×¡" in state_attr('binary_sensor.oref_alert', 'data').split(', ')
 or "×‘×™×ª ×—× ×Ÿ" in state_attr('binary_sensor.oref_alert', 'data').split(', ')
 or "×’×Ÿ ×©×•×¨×§" in state_attr('binary_sensor.oref_alert', 'data').split(', ') }}
```
**×”×’×“×¨×ª ×¡× ×¡×•×¨ ×‘×™× ××¨×™ ×—×“×©**
```
{{ ("××™×¨×•×¡" in state_attr('binary_sensor.oref_alert', 'prev_data').split(', ')
 or "×‘×™×ª ×—× ×Ÿ" in state_attr('binary_sensor.oref_alert', 'prev_data').split(', ')
 or "×’×Ÿ ×©×•×¨×§" in state_attr('binary_sensor.oref_alert', 'prev_data').split(', '))
 and is_state('binary_sensor.oref_alert','on') }}
```
### ×¢×¨×™× ×”××—×•×œ×§×•×ª ×œ××–×•×¨×™×
×‘××™×“×” ×•×¨×•×¦×™× ×œ×§×‘×œ ×”×ª×¨×¢×” ×‘×›×œ ×”××–×•×¨×™× ×‘×¢×™×¨ (×‘×™×©×¨××œ 11 ×¢×¨×™× ×”××—×•×œ×§×•×ª ×œ××–×•×¨×™×)

**×˜×¨×™×’×¨ ×¢×‘×•×¨ ×ª×¨×—×™×©×™×**
```
{{ state_attr('binary_sensor.oref_alert', 'data') | regex_search("×ª×œ ××‘×™×‘") }} 
```
**×”×’×“×¨×ª ×¡× ×¡×•×¨ ×‘×™× ××¨×™ ×—×“×©**
```
{{ state_attr('binary_sensor.oref_alert', 'prev_data') | regex_search("×ª×œ ××‘×™×‘")
and is_state('binary_sensor.oref_alert','on') }}
```
## ×©×™××•×©×™×
### ×›×¨×˜×™×¡×™×™×”
×œ×“×•×’×× ×œ×§×•×“ ×”××¦×™×’ ××™×“×¢ ×¢×œ ××¡×¤×¨ ×”×ª×¨×¢×•×ª ×¤×¢×™×œ×•×ª, ×¡×•×’ ×”×”×ª×¨×¢×”, ×¢×¨×™× ×•×”×¡×‘×¨ ×”×ª×’×•× × ×•×ª.
![TILIM](https://github.com/idodov/RedAlert/assets/19820046/f8ad780b-7e64-4c54-ab74-79e7ff56b780)

```yaml
type: markdown
content: >-
  <center><h3>{% if state_attr('binary_sensor.oref_alert', 'data_count') > 0 %}
  ×›×¨×’×¢ ×™×© {% if state_attr('binary_sensor.oref_alert', 'data_count') > 1 %}{{
  state_attr('binary_sensor.oref_alert', 'data_count') }} ×”×ª×¨×¢×•×ª ×¤×¢×™×œ×•×ª{% elif
  state_attr('binary_sensor.oref_alert', 'data_count') == 1 %} ×”×ª×¨×¢×” ×¤×¢×™×œ×” ××—×ª{%
  endif %}{% else %} ××™×Ÿ ×”×ª×¨×¢×•×ª ×¤×¢×™×œ×•×ª{% endif %}</h3>

  {% if state_attr('binary_sensor.oref_alert', 'data_count') > 0 %}<h2>{{
  state_attr('binary_sensor.oref_alert', 'emoji') }} {{
  state_attr('binary_sensor.oref_alert', 'title') }}</h2>
  <h3>{{ state_attr('binary_sensor.oref_alert', 'data') }}</h3>
  **{{ state_attr('binary_sensor.oref_alert', 'desc') }}** {% endif %} </center>
title: Red Alert
```
## ×ª×¨×—×™×© ×œ×“×•×’××
××¤×©×¨ ×‘×××¦×¢×•×ª ×”×—×™×™×©×Ÿ ×œ×™×™×¦×¨ ××’×•×•×Ÿ ×¨×—×‘ ×©×œ ×ª×¨×—×™×©×™×, ×œ×“×•×’×× - ×œ×©×œ×•×— ×”×ª×¨×¢×” ×œ××¡×š LED MATRIX ×›××• ×‘×“×•×’×× ×‘×ª××•× ×”.
![20231013_210149](https://github.com/idodov/RedAlert/assets/19820046/0f88c82c-c87a-4933-aec7-8db425f6515f)

### ×©×œ×™×—×ª ×”×ª×¨×¢×” ×œ×˜×œ×¤×•×Ÿ ×‘×›×œ ××™×¨×•×¢ ×¦×‘×¢ ××“×•×
```yaml
alias: Notify attack
description: "Real-time Attack Notification"
trigger:
  - platform: state
    entity_id:
      - binary_sensor.oref_alert
    from: "off"
    to: "on"
condition: []
action:
  - service: notify.mobile_app_#your phone#
    data:
      message: "{{ state_attr('binary_sensor.oref_alert', 'data') }}"
      title: "{{ state_attr('binary_sensor.oref_alert', 'emoji') }} {{ state_attr('binary_sensor.oref_alert', 'title') }}"
mode: single
```
### ×©×™× ×•×™ ×¦×‘×¢ ×”××•×¨×•×ª ×‘×‘×™×ª ×‘××™×“×” ×•×™×© ××–×¢×§×” ×‘×¢×™×¨ ×”××—×•×œ×§×ª ×œ××–×•×¨×™×
![20231013_221552](https://github.com/idodov/RedAlert/assets/19820046/6e60d5ca-12a9-4fd2-9b10-bcb19bf38a6d)
```yaml
alias: Alert in TLV
description: "When an alert occurs in Tel Aviv, the lights will cyclically change to red and blue for a duration of 30 seconds, after which they will revert to their previous states"
trigger:
  - platform: template
    id: TLV
    value_template: >-
      {{ state_attr('binary_sensor.oref_alert', 'data') | regex_search("×ª×œ ××‘×™×‘") }}
condition: []
action:
  - service: scene.create
    data:
      scene_id: before_oref_alert
      snapshot_entities:
        - light.#light-1#
        - light.#light-2#
        - light.#light-3#
  - repeat:
      count: 30
      sequence:
        - service: light.turn_on
          data:
            color_name: blue
          target:
            entity_id: 
            - light.#light-1#
            - light.#light-2#
            - light.#light-3#
        - delay:
            hours: 0
            minutes: 0
            seconds: 0
            milliseconds: 500
        - service: light.turn_on
          data:
            color_name: red
          target:
            entity_id: 
            - light.#light-1#
            - light.#light-2#
            - light.#light-3#
        - delay:
            hours: 0
            minutes: 0
            seconds: 0
            milliseconds: 500
  - service: scene.turn_on
    data: {}
    target:
      entity_id: scene.before_oref_alert
mode: single
```
